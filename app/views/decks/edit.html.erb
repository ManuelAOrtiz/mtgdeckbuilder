<!-- The page defaults to looking for all the cards in Magic -->
<%= form_tag "/search", :name => "searchForm"  do %> <!-- this form does the search for the cards -->
<div>
	<div>Name: <input type="text" name="card_name" id="card_name" placeholder="Enter the name of the card"></div>
	<div>
		Color:
		<select id="card_color" name="card_color">
			<option value="">Select a color</option>
			<option value="Red">Red</option>
			<option value="Green">Green</option>
			<option value="Black">Black</option>
			<option value="Blue">Blue</option>
			<option value="White">White</option>
		</select>
	</div>

	<div>
	    Types:
		
			<%=select_tag "card_type", options_from_collection_for_select($type, "to_s" , "to_s" ),{:include_blank => 'Type list'} %>
    </div>
    <div>
	    Creature Type:
		
			<%=select_tag "creature_type", options_from_collection_for_select($creaturetype, 'to_s', 'to_s'),{:include_blank => 'Creature Type list'} %>
    </div>
	
	<div>
	    Set:
			<%=select_tag "set", options_from_collection_for_select($set, 'code', 'name'),{:include_blank => 'Set list'} %>
    </div>
    <input type="hidden" name="user_id" value="<%= current_user.id %>">
    <input type="hidden" name="deck_id" value="<%= params[:id] %>">
    <input type="hidden" name="page_id" value="edit">
    <input type="submit" id="search" value="Search">
</div>
<% end %>

<div class='card-result-wrapper'>
    <% @cards.each_with_index do |card, i| %>
      <div class='card-result'>
        <% if card.image_url == nil %>
        	<div class='card-image' style="background-image: url(<%= image_url('mtg_cardback.jpg')%>)"></div>
      	<% else %>
        	<div class='card-image' style="background-image: url(<%= card.image_url %>)"></div>
      	<% end %>
        <div class='card-information'>
          <h3 class='card-name'><%= card.name %></h3>
          <p class='card-mana-cost'><%= card.mana_cost %></p>
          <p class='card-type'><%= card.type %></p>
          	<% if card.subtypes == nil %>
          		<p class='card-subtype'></p>
          	<% else %>
          		<p class='card-subtype'><%= card.subtypes.join(', ') %></p>
          	<% end %>
          <p class='card-set'><%= card.set_name %></p>
          <p class='card-rarity'><%= card.rarity %></p>
          	<% if user_signed_in? %>
	            <% if current_user.id == @deck.user_id %>
			          <%= form_tag "/addcard", :name => "addCard" do %>
			            <%= hidden_field_tag :deck_id, @deck.id %>
			            <%= hidden_field_tag :user_id, current_user.id %>
			            <%= hidden_field_tag :card_id, card.id %>
			            <input type='submit' value="add card">
			          <% end %>
		        <% end %>
	    	<% end %>
        </div>
      </div>
    <% end %>
</div>

  <div class='deck-list-wrapper'>
    <h2 class='deck-title'>Deck List</h2>

		<% @deck_card_names.each_with_index do |c, i| %>
			<% if  @deck_card_images[i] == nil || @deck_card_images[i] == "nil" %>
				<div class='deck-list-card' style="background-image: url(<%= image_url('mtg_cardback.jpg') %>)"><%= c %></div>
			<% else %>
				<div class='deck-list-card' style="background-image: url(<%= @deck_card_images[i] %>)"><%= c %></div>
			<% end %>
			<% if user_signed_in? %>
	          	<% if current_user.id == @deck.user_id %>
					<%= form_tag "/remove_card" , :name => "removeCard" do %>
						<%= hidden_field_tag :card_index, i %>
						<%= hidden_field_tag :deck_id, @deck.id %>
						<input type="submit" value="remove card">
					<% end %>
				<% end %>
			<% end %>
		<% end %>

		<% @card_list_hash.each_with_index do |(cname, num), i| %>
			<% if @image_set_array[i] == nil %>
				<div class='deck-list-card' style="background-image: url(<%= image_url('mtg_cardback.jpg') %>)"><%= num.to_s + "x - " + cname %></div>
			<% else %>
				<div class='deck-list-card' style="background-image: url(<%= @image_set_array[i] %>)"><%= num.to_s + "x - " + cname %></div>
			<% end %>

		<% end %>

    <h3 class='card-type-deck-title'>Creature</h3>
    <div class='creature-list type-list'></div>
    <h3 class='card-type-deck-title'>Sorcery</h3>
    <div class='sorcery-list type-list'></div>
    <h3 class='card-type-deck-title'>Instant</h3>
    <div class='instant-list type-list'></div>
    <h3 class='card-type-deck-title'>Artifacts</h3>
    <div class='artifact-list type-list'></div>
    <h3 class='card-type-deck-title'>Enchantments</h3>
    <div class='enchantment-list type-list'></div>
    <h3 class='card-type-deck-title'>Lands</h3>
    <div class='lands-list type-list'></div>
</div>
<div>
	<% if @pagenum.to_i <= 1 %>
		<ul>
			<!-- this link goes to the next page of all the cards in magic if its on page 1 -->
			<li> <a href="/users/<%= @user.id %>/decks/<%= @deck.id %>/edit/<%= @pagenum.to_i + 1 %>">Next</a></li>
		</ul>
	<% else %>
		<ul>
			<!-- these links goes to the pages of all the cards based on what page you are on. -->
			<li> <a href="/users/<%= @user.id %>/decks/<%= @deck.id %>/edit/<%= @pagenum.to_i + 1 %>">Next</a></li>
			<li> <a href="/users/<%= @user.id %>/decks/<%= @deck.id %>/edit/<%= @pagenum.to_i - 1 %>">Previous</a></li>
		</ul>
	<% end %>
</div>
